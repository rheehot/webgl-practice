{"mappings":"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","sources":["./src/index.js","./lib/sylvester.js","./lib/sylvester-utils.js"],"sourcesContent":["var sylvester, Matrix, $V, makePerspective, gl\nsylvester = require('sylvester')\nrequire('sylvester-utils')\nMatrix = sylvester.Matrix\n$V = sylvester.Vector.create\nmakePerspective = sylvester.makePerspective\ngl = (function (canvas) {\n  var e\n  try {\n    return canvas.getContext('webgl') || canvas.getContext('experimental-webgl')\n  } catch (e$) {\n    e = e$\n    throw Error('unimplemented')\n  }\n})(document.getElementById('screen'))\n;(function (it) {\n  return it.call(gl)\n})(function () {\n  var flag,\n    makeShader,\n    vs,\n    fs,\n    program,\n    makeAttr,\n    vertexPositionAttribute,\n    vertexColorAttribute,\n    makeBuffer,\n    vb,\n    colorb,\n    this$ = this\n  flag = {\n    resized: true,\n  }\n  window.addEventListener('resize', function () {\n    return (flag.resized = true)\n  })\n  this.clearColor(0.0, 0.0, 0.0, 1.0)\n  this.clearDepth(1.0)\n  this.enable(this.DEPTH_TEST)\n  this.depthFunc(this.LEQUAL)\n  makeShader = function (shader, code) {\n    this$.shaderSource(shader, code)\n    this$.compileShader(shader)\n    if (!this$.getShaderParameter(shader, this$.COMPILE_STATUS)) {\n      throw Error('unimplemented')\n    }\n    return shader\n  }\n  vs = makeShader(\n    this.createShader(this.VERTEX_SHADER),\n    'attribute vec3 aVertexPosition;\\nattribute vec4 aVertexColor;\\n\\nuniform mat4 uMVMatrix;\\nuniform mat4 uPMatrix;\\n\\nvarying lowp vec4 vColor;\\n\\nvoid main(void) {\\n  gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\\n  vColor = aVertexColor;\\n}'\n  )\n  fs = makeShader(\n    this.createShader(this.FRAGMENT_SHADER),\n    'varying lowp vec4 vColor;\\n\\nvoid main(void) {\\n  gl_FragColor = vColor;\\n}'\n  )\n  program = this.createProgram()\n  this.attachShader(program, vs)\n  this.attachShader(program, fs)\n  this.linkProgram(program)\n  if (!this.getProgramParameter(program, this.LINK_STATUS)) {\n    throw Error('unimplemented')\n  }\n  this.useProgram(program)\n  makeAttr = function (name) {\n    var attr\n    attr = this$.getAttribLocation(program, name)\n    this$.enableVertexAttribArray(attr)\n    return attr\n  }\n  vertexPositionAttribute = makeAttr('aVertexPosition')\n  vertexColorAttribute = makeAttr('aVertexColor')\n  makeBuffer = function (data) {\n    var ret\n    ret = this$.createBuffer()\n    this$.bindBuffer(this$.ARRAY_BUFFER, ret)\n    this$.bufferData(\n      this$.ARRAY_BUFFER,\n      new Float32Array(data),\n      this$.STATIC_DRAW\n    )\n    return ret\n  }\n  vb = makeBuffer([+1, +1, +0, -1, +1, +0, +1, -1, +0, -1, -1, +0])\n  colorb = makeBuffer([1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1])\n  return (function (foo) {\n    return setInterval(foo, 15)\n  })(function () {\n    var mvMatrix, mvUniform, pMatrix, pUniform\n    mvMatrix = Matrix.Translation($V([0, 0, -6])).ensure4x4()\n    mvUniform = this$.getUniformLocation(program, 'uMVMatrix')\n    this$.uniformMatrix4fv(\n      mvUniform,\n      false,\n      new Float32Array(mvMatrix.flatten())\n    )\n    pMatrix = makePerspective(45, 1, 0.1, 100.0)\n    pUniform = this$.getUniformLocation(program, 'uPMatrix')\n    this$.uniformMatrix4fv(pUniform, false, new Float32Array(pMatrix.flatten()))\n    this$.bindBuffer(this$.ARRAY_BUFFER, vb)\n    this$.vertexAttribPointer(\n      vertexPositionAttribute,\n      3,\n      this$.FLOAT,\n      false,\n      0,\n      0\n    )\n    this$.bindBuffer(this$.ARRAY_BUFFER, colorb)\n    this$.vertexAttribPointer(vertexColorAttribute, 4, this$.FLOAT, false, 0, 0)\n    this$.clear(this$.COLOR_BUFFER_BIT | this$.DEPTH_BUFFER_BIT)\n    this$.drawArrays(this$.TRIANGLE_STRIP, 0, 4)\n    if (flag.resized) {\n      return function (c) {\n        if (c.width !== c.clientWidth) {\n          c.width = c.clientWidth\n        }\n        if (c.height !== c.clientHeight) {\n          c.height = c.clientHeight\n        }\n        return this.viewport(0, 0, c.width, c.height)\n      }.call(this$, this$.canvas)\n    }\n  })\n})\n","var Sylvester = {\n  precision: 1e-6\n};\n\nSylvester.Vector = function() {};\n\nSylvester.Vector.create = function(elements) {\n  var V = new Sylvester.Vector();\n  return V.setElements(elements);\n};\nvar $V = Sylvester.Vector.create;\n\nSylvester.Vector.Random = function(n) {\n  var elements = [];\n  while (n--) { elements.push(Math.random()); }\n  return Sylvester.Vector.create(elements);\n};\n\nSylvester.Vector.Zero = function(n) {\n  var elements = [];\n  while (n--) { elements.push(0); }\n  return Sylvester.Vector.create(elements);\n};\n\nSylvester.Vector.prototype = {\n  e: function(i) {\n    return (i < 1 || i > this.elements.length) ? null : this.elements[i-1];\n  },\n\n  dimensions: function() {\n    return this.elements.length;\n  },\n\n  modulus: function() {\n    return Math.sqrt(this.dot(this));\n  },\n\n  eql: function(vector) {\n    var n = this.elements.length;\n    var V = vector.elements || vector;\n    if (n !== V.length) { return false; }\n    while (n--) {\n      if (Math.abs(this.elements[n] - V[n]) > Sylvester.precision) { return false; }\n    }\n    return true;\n  },\n\n  dup: function() {\n    return Sylvester.Vector.create(this.elements);\n  },\n\n  map: function(fn, context) {\n    var elements = [];\n    this.each(function(x, i) {\n      elements.push(fn.call(context, x, i));\n    });\n    return Sylvester.Vector.create(elements);\n  },\n\n  forEach: function(fn, context) {\n    var n = this.elements.length;\n    for (var i = 0; i < n; i++) {\n      fn.call(context, this.elements[i], i+1);\n    }\n  },\n\n  toUnitVector: function() {\n    var r = this.modulus();\n    if (r === 0) { return this.dup(); }\n    return this.map(function(x) { return x/r; });\n  },\n\n  angleFrom: function(vector) {\n    var V = vector.elements || vector;\n    var n = this.elements.length, k = n, i;\n    if (n !== V.length) { return null; }\n    var dot = 0, mod1 = 0, mod2 = 0;\n    // Work things out in parallel to save time\n    this.each(function(x, i) {\n      dot += x * V[i-1];\n      mod1 += x * x;\n      mod2 += V[i-1] * V[i-1];\n    });\n    mod1 = Math.sqrt(mod1); mod2 = Math.sqrt(mod2);\n    if (mod1*mod2 === 0) { return null; }\n    var theta = dot / (mod1*mod2);\n    if (theta < -1) { theta = -1; }\n    if (theta > 1) { theta = 1; }\n    return Math.acos(theta);\n  },\n\n  isParallelTo: function(vector) {\n    var angle = this.angleFrom(vector);\n    return (angle === null) ? null : (angle <= Sylvester.precision);\n  },\n\n  isAntiparallelTo: function(vector) {\n    var angle = this.angleFrom(vector);\n    return (angle === null) ? null : (Math.abs(angle - Math.PI) <= Sylvester.precision);\n  },\n\n  isPerpendicularTo: function(vector) {\n    var dot = this.dot(vector);\n    return (dot === null) ? null : (Math.abs(dot) <= Sylvester.precision);\n  },\n\n  add: function(vector) {\n    var V = vector.elements || vector;\n    if (this.elements.length !== V.length) { return null; }\n    return this.map(function(x, i) { return x + V[i-1]; });\n  },\n\n  subtract: function(vector) {\n    var V = vector.elements || vector;\n    if (this.elements.length !== V.length) { return null; }\n    return this.map(function(x, i) { return x - V[i-1]; });\n  },\n\n  multiply: function(k) {\n    return this.map(function(x) { return x*k; });\n  },\n\n  dot: function(vector) {\n    var V = vector.elements || vector;\n    var i, product = 0, n = this.elements.length;\n    if (n !== V.length) { return null; }\n    while (n--) { product += this.elements[n] * V[n]; }\n    return product;\n  },\n\n  cross: function(vector) {\n    var B = vector.elements || vector;\n    if (this.elements.length !== 3 || B.length !== 3) { return null; }\n    var A = this.elements;\n    return Sylvester.Vector.create([\n      (A[1] * B[2]) - (A[2] * B[1]),\n      (A[2] * B[0]) - (A[0] * B[2]),\n      (A[0] * B[1]) - (A[1] * B[0])\n    ]);\n  },\n\n  max: function() {\n    var m = 0, i = this.elements.length;\n    while (i--) {\n      if (Math.abs(this.elements[i]) > Math.abs(m)) { m = this.elements[i]; }\n    }\n    return m;\n  },\n\n  indexOf: function(x) {\n    var index = null, n = this.elements.length;\n    for (var i = 0; i < n; i++) {\n      if (index === null && this.elements[i] === x) {\n        index = i + 1;\n      }\n    }\n    return index;\n  },\n\n  toDiagonalMatrix: function() {\n    return Sylvester.Matrix.Diagonal(this.elements);\n  },\n\n  round: function() {\n    return this.map(function(x) { return Math.round(x); });\n  },\n\n  snapTo: function(x) {\n    return this.map(function(y) {\n      return (Math.abs(y - x) <= Sylvester.precision) ? x : y;\n    });\n  },\n\n  distanceFrom: function(obj) {\n    if (obj.anchor || (obj.start && obj.end)) { return obj.distanceFrom(this); }\n    var V = obj.elements || obj;\n    if (V.length !== this.elements.length) { return null; }\n    var sum = 0, part;\n    this.each(function(x, i) {\n      part = x - V[i-1];\n      sum += part * part;\n    });\n    return Math.sqrt(sum);\n  },\n\n  liesOn: function(line) {\n    return line.contains(this);\n  },\n\n  liesIn: function(plane) {\n    return plane.contains(this);\n  },\n\n  rotate: function(t, obj) {\n    var V, R = null, x, y, z;\n    if (t.determinant) { R = t.elements; }\n    switch (this.elements.length) {\n      case 2:\n        V = obj.elements || obj;\n        if (V.length !== 2) { return null; }\n        if (!R) { R = Sylvester.Matrix.Rotation(t).elements; }\n        x = this.elements[0] - V[0];\n        y = this.elements[1] - V[1];\n        return Sylvester.Vector.create([\n          V[0] + R[0][0] * x + R[0][1] * y,\n          V[1] + R[1][0] * x + R[1][1] * y\n        ]);\n        break;\n      case 3:\n        if (!obj.direction) { return null; }\n        var C = obj.pointClosestTo(this).elements;\n        if (!R) { R = Sylvester.Matrix.Rotation(t, obj.direction).elements; }\n        x = this.elements[0] - C[0];\n        y = this.elements[1] - C[1];\n        z = this.elements[2] - C[2];\n        return Sylvester.Vector.create([\n          C[0] + R[0][0] * x + R[0][1] * y + R[0][2] * z,\n          C[1] + R[1][0] * x + R[1][1] * y + R[1][2] * z,\n          C[2] + R[2][0] * x + R[2][1] * y + R[2][2] * z\n        ]);\n        break;\n      default:\n        return null;\n    }\n  },\n\n  reflectionIn: function(obj) {\n    if (obj.anchor) {\n      // obj is a plane or line\n      var P = this.elements.slice();\n      var C = obj.pointClosestTo(P).elements;\n      return Sylvester.Vector.create([C[0] + (C[0] - P[0]), C[1] + (C[1] - P[1]), C[2] + (C[2] - (P[2] || 0))]);\n    } else {\n      // obj is a point\n      var Q = obj.elements || obj;\n      if (this.elements.length !== Q.length) { return null; }\n      return this.map(function(x, i) { return Q[i-1] + (Q[i-1] - x); });\n    }\n  },\n\n  to3D: function() {\n    var V = this.dup();\n    switch (V.elements.length) {\n      case 3: break;\n      case 2: V.elements.push(0); break;\n      default: return null;\n    }\n    return V;\n  },\n\n  inspect: function() {\n    return '[' + this.elements.join(', ') + ']';\n  },\n\n  setElements: function(els) {\n    this.elements = (els.elements || els).slice();\n    return this;\n  }\n};\n\nSylvester.Vector.prototype.x = Sylvester.Vector.prototype.multiply;\nSylvester.Vector.prototype.each = Sylvester.Vector.prototype.forEach;\n\nSylvester.Vector.i = Sylvester.Vector.create([1,0,0]);\nSylvester.Vector.j = Sylvester.Vector.create([0,1,0]);\nSylvester.Vector.k = Sylvester.Vector.create([0,0,1]);\n\nSylvester.Matrix = function() {};\n\nSylvester.Matrix.create = function(elements) {\n  var M = new Sylvester.Matrix();\n  return M.setElements(elements);\n};\nvar $M = Sylvester.Matrix.create;\n\nSylvester.Matrix.I = function(n) {\n  var els = [], i = n, j;\n  while (i--) { j = n;\n    els[i] = [];\n    while (j--) {\n      els[i][j] = (i === j) ? 1 : 0;\n    }\n  }\n  return Sylvester.Matrix.create(els);\n};\n\nSylvester.Matrix.Diagonal = function(elements) {\n  var i = elements.length;\n  var M = Sylvester.Matrix.I(i);\n  while (i--) {\n    M.elements[i][i] = elements[i];\n  }\n  return M;\n};\n\nSylvester.Matrix.Rotation = function(theta, a) {\n  if (!a) {\n    return Sylvester.Matrix.create([\n      [Math.cos(theta),  -Math.sin(theta)],\n      [Math.sin(theta),   Math.cos(theta)]\n    ]);\n  }\n  var axis = a.dup();\n  if (axis.elements.length !== 3) { return null; }\n  var mod = axis.modulus();\n  var x = axis.elements[0]/mod, y = axis.elements[1]/mod, z = axis.elements[2]/mod;\n  var s = Math.sin(theta), c = Math.cos(theta), t = 1 - c;\n  // Formula derived here: http://www.gamedev.net/reference/articles/article1199.asp\n  // That proof rotates the co-ordinate system so theta becomes -theta and sin\n  // becomes -sin here.\n  return Sylvester.Matrix.create([\n    [ t*x*x + c, t*x*y - s*z, t*x*z + s*y ],\n    [ t*x*y + s*z, t*y*y + c, t*y*z - s*x ],\n    [ t*x*z - s*y, t*y*z + s*x, t*z*z + c ]\n  ]);\n};\n\nSylvester.Matrix.RotationX = function(t) {\n  var c = Math.cos(t), s = Math.sin(t);\n  return Sylvester.Matrix.create([\n    [  1,  0,  0 ],\n    [  0,  c, -s ],\n    [  0,  s,  c ]\n  ]);\n};\nSylvester.Matrix.RotationY = function(t) {\n  var c = Math.cos(t), s = Math.sin(t);\n  return Sylvester.Matrix.create([\n    [  c,  0,  s ],\n    [  0,  1,  0 ],\n    [ -s,  0,  c ]\n  ]);\n};\nSylvester.Matrix.RotationZ = function(t) {\n  var c = Math.cos(t), s = Math.sin(t);\n  return Sylvester.Matrix.create([\n    [  c, -s,  0 ],\n    [  s,  c,  0 ],\n    [  0,  0,  1 ]\n  ]);\n};\n\nSylvester.Matrix.Random = function(n, m) {\n  return Sylvester.Matrix.Zero(n, m).map(\n    function() { return Math.random(); }\n  );\n};\n\nSylvester.Matrix.Zero = function(n, m) {\n  var els = [], i = n, j;\n  while (i--) { j = m;\n    els[i] = [];\n    while (j--) {\n      els[i][j] = 0;\n    }\n  }\n  return Sylvester.Matrix.create(els);\n};\n\nSylvester.Matrix.prototype = {\n  e: function(i,j) {\n    if (i < 1 || i > this.elements.length || j < 1 || j > this.elements[0].length) { return null; }\n    return this.elements[i-1][j-1];\n  },\n\n  row: function(i) {\n    if (i > this.elements.length) { return null; }\n    return Sylvester.Vector.create(this.elements[i-1]);\n  },\n\n  col: function(j) {\n    if (this.elements.length === 0) { return null; }\n    if (j > this.elements[0].length) { return null; }\n    var col = [], n = this.elements.length;\n    for (var i = 0; i < n; i++) { col.push(this.elements[i][j-1]); }\n    return Sylvester.Vector.create(col);\n  },\n\n  dimensions: function() {\n    var cols = (this.elements.length === 0) ? 0 : this.elements[0].length;\n    return {rows: this.elements.length, cols: cols};\n  },\n\n  rows: function() {\n    return this.elements.length;\n  },\n\n  cols: function() {\n    if (this.elements.length === 0) { return 0; }\n    return this.elements[0].length;\n  },\n\n  eql: function(matrix) {\n    var M = matrix.elements || matrix;\n    if (!M[0] || typeof(M[0][0]) === 'undefined') { M = Sylvester.Matrix.create(M).elements; }\n    if (this.elements.length === 0 || M.length === 0) {\n      return this.elements.length === M.length;\n    }\n    if (this.elements.length !== M.length) { return false; }\n    if (this.elements[0].length !== M[0].length) { return false; }\n    var i = this.elements.length, nj = this.elements[0].length, j;\n    while (i--) { j = nj;\n      while (j--) {\n        if (Math.abs(this.elements[i][j] - M[i][j]) > Sylvester.precision) { return false; }\n      }\n    }\n    return true;\n  },\n\n  dup: function() {\n    return Sylvester.Matrix.create(this.elements);\n  },\n\n  map: function(fn, context) {\n    if (this.elements.length === 0) { return Sylvester.Matrix.create([]); }\n    var els = [], i = this.elements.length, nj = this.elements[0].length, j;\n    while (i--) { j = nj;\n      els[i] = [];\n      while (j--) {\n        els[i][j] = fn.call(context, this.elements[i][j], i + 1, j + 1);\n      }\n    }\n    return Sylvester.Matrix.create(els);\n  },\n\n  isSameSizeAs: function(matrix) {\n    var M = matrix.elements || matrix;\n    if (typeof(M[0][0]) === 'undefined') { M = Sylvester.Matrix.create(M).elements; }\n    if (this.elements.length === 0) { return M.length === 0; }\n    return (this.elements.length === M.length &&\n        this.elements[0].length === M[0].length);\n  },\n\n  add: function(matrix) {\n    if (this.elements.length === 0) return this.map(function(x) { return x });\n    var M = matrix.elements || matrix;\n    if (typeof(M[0][0]) === 'undefined') { M = Sylvester.Matrix.create(M).elements; }\n    if (!this.isSameSizeAs(M)) { return null; }\n    return this.map(function(x, i, j) { return x + M[i-1][j-1]; });\n  },\n\n  subtract: function(matrix) {\n    if (this.elements.length === 0) return this.map(function(x) { return x });\n    var M = matrix.elements || matrix;\n    if (typeof(M[0][0]) === 'undefined') { M = Sylvester.Matrix.create(M).elements; }\n    if (!this.isSameSizeAs(M)) { return null; }\n    return this.map(function(x, i, j) { return x - M[i-1][j-1]; });\n  },\n\n  canMultiplyFromLeft: function(matrix) {\n    if (this.elements.length === 0) { return false; }\n    var M = matrix.elements || matrix;\n    if (typeof(M[0][0]) === 'undefined') { M = Sylvester.Matrix.create(M).elements; }\n    // this.columns should equal matrix.rows\n    return (this.elements[0].length === M.length);\n  },\n\n  multiply: function(matrix) {\n    if (this.elements.length === 0) { return null; }\n    if (!matrix.elements) {\n      return this.map(function(x) { return x * matrix; });\n    }\n    var returnVector = matrix.modulus ? true : false;\n    var M = matrix.elements || matrix;\n    if (typeof(M[0][0]) === 'undefined') { M = Sylvester.Matrix.create(M).elements; }\n    if (!this.canMultiplyFromLeft(M)) { return null; }\n    var i = this.elements.length, nj = M[0].length, j;\n    var cols = this.elements[0].length, c, elements = [], sum;\n    while (i--) { j = nj;\n      elements[i] = [];\n      while (j--) { c = cols;\n        sum = 0;\n        while (c--) {\n          sum += this.elements[i][c] * M[c][j];\n        }\n        elements[i][j] = sum;\n      }\n    }\n    var M = Sylvester.Matrix.create(elements);\n    return returnVector ? M.col(1) : M;\n  },\n\n  minor: function(a, b, c, d) {\n    if (this.elements.length === 0) { return null; }\n    var elements = [], ni = c, i, nj, j;\n    var rows = this.elements.length, cols = this.elements[0].length;\n    while (ni--) { i = c - ni - 1;\n      elements[i] = [];\n      nj = d;\n      while (nj--) { j = d - nj - 1;\n        elements[i][j] = this.elements[(a+i-1)%rows][(b+j-1)%cols];\n      }\n    }\n    return Sylvester.Matrix.create(elements);\n  },\n\n  transpose: function() {\n    if (this.elements.length === 0) return Sylvester.Matrix.create([]);\n    var rows = this.elements.length, i, cols = this.elements[0].length, j;\n    var elements = [], i = cols;\n    while (i--) { j = rows;\n      elements[i] = [];\n      while (j--) {\n        elements[i][j] = this.elements[j][i];\n      }\n    }\n    return Sylvester.Matrix.create(elements);\n  },\n\n  isSquare: function() {\n    var cols = (this.elements.length === 0) ? 0 : this.elements[0].length;\n    return (this.elements.length === cols);\n  },\n\n  max: function() {\n    if (this.elements.length === 0) { return null; }\n    var m = 0, i = this.elements.length, nj = this.elements[0].length, j;\n    while (i--) { j = nj;\n      while (j--) {\n        if (Math.abs(this.elements[i][j]) > Math.abs(m)) { m = this.elements[i][j]; }\n      }\n    }\n    return m;\n  },\n\n  indexOf: function(x) {\n    if (this.elements.length === 0) { return null; }\n    var index = null, ni = this.elements.length, i, nj = this.elements[0].length, j;\n    for (i = 0; i < ni; i++) {\n      for (j = 0; j < nj; j++) {\n        if (this.elements[i][j] === x) { return {i: i+1, j: j+1}; }\n      }\n    }\n    return null;\n  },\n\n  diagonal: function() {\n    if (!this.isSquare) { return null; }\n    var els = [], n = this.elements.length;\n    for (var i = 0; i < n; i++) {\n      els.push(this.elements[i][i]);\n    }\n    return Sylvester.Vector.create(els);\n  },\n\n  toRightTriangular: function() {\n    if (this.elements.length === 0) return Sylvester.Matrix.create([]);\n    var M = this.dup(), els;\n    var n = this.elements.length, i, j, np = this.elements[0].length, p;\n    for (i = 0; i < n; i++) {\n      if (M.elements[i][i] === 0) {\n        for (j = i + 1; j < n; j++) {\n          if (M.elements[j][i] !== 0) {\n            els = [];\n            for (p = 0; p < np; p++) { els.push(M.elements[i][p] + M.elements[j][p]); }\n            M.elements[i] = els;\n            break;\n          }\n        }\n      }\n      if (M.elements[i][i] !== 0) {\n        for (j = i + 1; j < n; j++) {\n          var multiplier = M.elements[j][i] / M.elements[i][i];\n          els = [];\n          for (p = 0; p < np; p++) {\n            // Elements with column numbers up to an including the number of the\n            // row that we're subtracting can safely be set straight to zero,\n            // since that's the point of this routine and it avoids having to\n            // loop over and correct rounding errors later\n            els.push(p <= i ? 0 : M.elements[j][p] - M.elements[i][p] * multiplier);\n          }\n          M.elements[j] = els;\n        }\n      }\n    }\n    return M;\n  },\n\n  determinant: function() {\n    if (this.elements.length === 0) { return 1; }\n    if (!this.isSquare()) { return null; }\n    var M = this.toRightTriangular();\n    var det = M.elements[0][0], n = M.elements.length;\n    for (var i = 1; i < n; i++) {\n      det = det * M.elements[i][i];\n    }\n    return det;\n  },\n\n  isSingular: function() {\n    return (this.isSquare() && this.determinant() === 0);\n  },\n\n  trace: function() {\n    if (this.elements.length === 0) { return 0; }\n    if (!this.isSquare()) { return null; }\n    var tr = this.elements[0][0], n = this.elements.length;\n    for (var i = 1; i < n; i++) {\n      tr += this.elements[i][i];\n    }\n    return tr;\n  },\n\n  rank: function() {\n    if (this.elements.length === 0) { return 0; }\n    var M = this.toRightTriangular(), rank = 0;\n    var i = this.elements.length, nj = this.elements[0].length, j;\n    while (i--) { j = nj;\n      while (j--) {\n        if (Math.abs(M.elements[i][j]) > Sylvester.precision) { rank++; break; }\n      }\n    }\n    return rank;\n  },\n\n  augment: function(matrix) {\n    if (this.elements.length === 0) { return this.dup(); }\n    var M = matrix.elements || matrix;\n    if (typeof(M[0][0]) === 'undefined') { M = Sylvester.Matrix.create(M).elements; }\n    var T = this.dup(), cols = T.elements[0].length;\n    var i = T.elements.length, nj = M[0].length, j;\n    if (i !== M.length) { return null; }\n    while (i--) { j = nj;\n      while (j--) {\n        T.elements[i][cols + j] = M[i][j];\n      }\n    }\n    return T;\n  },\n\n  inverse: function() {\n    if (this.elements.length === 0) { return null; }\n    if (!this.isSquare() || this.isSingular()) { return null; }\n    var n = this.elements.length, i= n, j;\n    var M = this.augment(Sylvester.Matrix.I(n)).toRightTriangular();\n    var np = M.elements[0].length, p, els, divisor;\n    var inverse_elements = [], new_element;\n    // Sylvester.Matrix is non-singular so there will be no zeros on the\n    // diagonal. Cycle through rows from last to first.\n    while (i--) {\n      // First, normalise diagonal elements to 1\n      els = [];\n      inverse_elements[i] = [];\n      divisor = M.elements[i][i];\n      for (p = 0; p < np; p++) {\n        new_element = M.elements[i][p] / divisor;\n        els.push(new_element);\n        // Shuffle off the current row of the right hand side into the results\n        // array as it will not be modified by later runs through this loop\n        if (p >= n) { inverse_elements[i].push(new_element); }\n      }\n      M.elements[i] = els;\n      // Then, subtract this row from those above it to give the identity matrix\n      // on the left hand side\n      j = i;\n      while (j--) {\n        els = [];\n        for (p = 0; p < np; p++) {\n          els.push(M.elements[j][p] - M.elements[i][p] * M.elements[j][i]);\n        }\n        M.elements[j] = els;\n      }\n    }\n    return Sylvester.Matrix.create(inverse_elements);\n  },\n\n  round: function() {\n    return this.map(function(x) { return Math.round(x); });\n  },\n\n  snapTo: function(x) {\n    return this.map(function(p) {\n      return (Math.abs(p - x) <= Sylvester.precision) ? x : p;\n    });\n  },\n\n  inspect: function() {\n    var matrix_rows = [];\n    var n = this.elements.length;\n    if (n === 0) return '[]';\n    for (var i = 0; i < n; i++) {\n      matrix_rows.push(Sylvester.Vector.create(this.elements[i]).inspect());\n    }\n    return matrix_rows.join('\\n');\n  },\n\n  setElements: function(els) {\n    var i, j, elements = els.elements || els;\n    if (elements[0] && typeof(elements[0][0]) !== 'undefined') {\n      i = elements.length;\n      this.elements = [];\n      while (i--) { j = elements[i].length;\n        this.elements[i] = [];\n        while (j--) {\n          this.elements[i][j] = elements[i][j];\n        }\n      }\n      return this;\n    }\n    var n = elements.length;\n    this.elements = [];\n    for (i = 0; i < n; i++) {\n      this.elements.push([elements[i]]);\n    }\n    return this;\n  }\n};\n\nSylvester.Matrix.prototype.toUpperTriangular = Sylvester.Matrix.prototype.toRightTriangular;\nSylvester.Matrix.prototype.det = Sylvester.Matrix.prototype.determinant;\nSylvester.Matrix.prototype.tr = Sylvester.Matrix.prototype.trace;\nSylvester.Matrix.prototype.rk = Sylvester.Matrix.prototype.rank;\nSylvester.Matrix.prototype.inv = Sylvester.Matrix.prototype.inverse;\nSylvester.Matrix.prototype.x = Sylvester.Matrix.prototype.multiply;\n\nSylvester.Line = function() {};\n\nSylvester.Line.prototype = {\n  eql: function(line) {\n    return (this.isParallelTo(line) && this.contains(line.anchor));\n  },\n\n  dup: function() {\n    return Sylvester.Line.create(this.anchor, this.direction);\n  },\n\n  translate: function(vector) {\n    var V = vector.elements || vector;\n    return Sylvester.Line.create([\n      this.anchor.elements[0] + V[0],\n      this.anchor.elements[1] + V[1],\n      this.anchor.elements[2] + (V[2] || 0)\n    ], this.direction);\n  },\n\n  isParallelTo: function(obj) {\n    if (obj.normal || (obj.start && obj.end)) { return obj.isParallelTo(this); }\n    var theta = this.direction.angleFrom(obj.direction);\n    return (Math.abs(theta) <= Sylvester.precision || Math.abs(theta - Math.PI) <= Sylvester.precision);\n  },\n\n  distanceFrom: function(obj) {\n    if (obj.normal || (obj.start && obj.end)) { return obj.distanceFrom(this); }\n    if (obj.direction) {\n      // obj is a line\n      if (this.isParallelTo(obj)) { return this.distanceFrom(obj.anchor); }\n      var N = this.direction.cross(obj.direction).toUnitVector().elements;\n      var A = this.anchor.elements, B = obj.anchor.elements;\n      return Math.abs((A[0] - B[0]) * N[0] + (A[1] - B[1]) * N[1] + (A[2] - B[2]) * N[2]);\n    } else {\n      // obj is a point\n      var P = obj.elements || obj;\n      var A = this.anchor.elements, D = this.direction.elements;\n      var PA1 = P[0] - A[0], PA2 = P[1] - A[1], PA3 = (P[2] || 0) - A[2];\n      var modPA = Math.sqrt(PA1*PA1 + PA2*PA2 + PA3*PA3);\n      if (modPA === 0) return 0;\n      // Assumes direction vector is normalized\n      var cosTheta = (PA1 * D[0] + PA2 * D[1] + PA3 * D[2]) / modPA;\n      var sin2 = 1 - cosTheta*cosTheta;\n      return Math.abs(modPA * Math.sqrt(sin2 < 0 ? 0 : sin2));\n    }\n  },\n\n  contains: function(obj) {\n    if (obj.start && obj.end) { return this.contains(obj.start) && this.contains(obj.end); }\n    var dist = this.distanceFrom(obj);\n    return (dist !== null && dist <= Sylvester.precision);\n  },\n\n  positionOf: function(point) {\n    if (!this.contains(point)) { return null; }\n    var P = point.elements || point;\n    var A = this.anchor.elements, D = this.direction.elements;\n    return (P[0] - A[0]) * D[0] + (P[1] - A[1]) * D[1] + ((P[2] || 0) - A[2]) * D[2];\n  },\n\n  liesIn: function(plane) {\n    return plane.contains(this);\n  },\n\n  intersects: function(obj) {\n    if (obj.normal) { return obj.intersects(this); }\n    return (!this.isParallelTo(obj) && this.distanceFrom(obj) <= Sylvester.precision);\n  },\n\n  intersectionWith: function(obj) {\n    if (obj.normal || (obj.start && obj.end)) { return obj.intersectionWith(this); }\n    if (!this.intersects(obj)) { return null; }\n    var P = this.anchor.elements, X = this.direction.elements,\n        Q = obj.anchor.elements, Y = obj.direction.elements;\n    var X1 = X[0], X2 = X[1], X3 = X[2], Y1 = Y[0], Y2 = Y[1], Y3 = Y[2];\n    var PsubQ1 = P[0] - Q[0], PsubQ2 = P[1] - Q[1], PsubQ3 = P[2] - Q[2];\n    var XdotQsubP = - X1*PsubQ1 - X2*PsubQ2 - X3*PsubQ3;\n    var YdotPsubQ = Y1*PsubQ1 + Y2*PsubQ2 + Y3*PsubQ3;\n    var XdotX = X1*X1 + X2*X2 + X3*X3;\n    var YdotY = Y1*Y1 + Y2*Y2 + Y3*Y3;\n    var XdotY = X1*Y1 + X2*Y2 + X3*Y3;\n    var k = (XdotQsubP * YdotY / XdotX + XdotY * YdotPsubQ) / (YdotY - XdotY * XdotY);\n    return Sylvester.Vector.create([P[0] + k*X1, P[1] + k*X2, P[2] + k*X3]);\n  },\n\n  pointClosestTo: function(obj) {\n    if (obj.start && obj.end) {\n      // obj is a line segment\n      var P = obj.pointClosestTo(this);\n      return (P === null) ? null : this.pointClosestTo(P);\n    } else if (obj.direction) {\n      // obj is a line\n      if (this.intersects(obj)) { return this.intersectionWith(obj); }\n      if (this.isParallelTo(obj)) { return null; }\n      var D = this.direction.elements, E = obj.direction.elements;\n      var D1 = D[0], D2 = D[1], D3 = D[2], E1 = E[0], E2 = E[1], E3 = E[2];\n      // Create plane containing obj and the shared normal and intersect this\n      // with it Thank you:\n      // http://www.cgafaq.info/wiki/Sylvester.Line-line_distance\n      var x = (D3 * E1 - D1 * E3), y = (D1 * E2 - D2 * E1), z = (D2 * E3 - D3 * E2);\n      var N = [x * E3 - y * E2, y * E1 - z * E3, z * E2 - x * E1];\n      var P = Sylvester.Plane.create(obj.anchor, N);\n      return P.intersectionWith(this);\n    } else {\n      // obj is a point\n      var P = obj.elements || obj;\n      if (this.contains(P)) { return Sylvester.Vector.create(P); }\n      var A = this.anchor.elements, D = this.direction.elements;\n      var D1 = D[0], D2 = D[1], D3 = D[2], A1 = A[0], A2 = A[1], A3 = A[2];\n      var x = D1 * (P[1]-A2) - D2 * (P[0]-A1), y = D2 * ((P[2] || 0) - A3) - D3 * (P[1]-A2),\n          z = D3 * (P[0]-A1) - D1 * ((P[2] || 0) - A3);\n      var V = Sylvester.Vector.create([D2 * x - D3 * z, D3 * y - D1 * x, D1 * z - D2 * y]);\n      var k = this.distanceFrom(P) / V.modulus();\n      return Sylvester.Vector.create([\n        P[0] + V.elements[0] * k,\n        P[1] + V.elements[1] * k,\n        (P[2] || 0) + V.elements[2] * k\n      ]);\n    }\n  },\n\n  // Returns a copy of the line rotated by t radians about the given line. Works\n  // by finding the argument's closest point to this line's anchor point (call\n  // this C) and rotating the anchor about C. Also rotates the line's direction\n  // about the argument's. Be careful with this - the rotation axis' direction\n  // affects the outcome!\n  rotate: function(t, line) {\n    // If we're working in 2D\n    if (typeof(line.direction) === 'undefined') { line = Sylvester.Line.create(line.to3D(), Sylvester.Vector.k); }\n    var R = Sylvester.Matrix.Rotation(t, line.direction).elements;\n    var C = line.pointClosestTo(this.anchor).elements;\n    var A = this.anchor.elements, D = this.direction.elements;\n    var C1 = C[0], C2 = C[1], C3 = C[2], A1 = A[0], A2 = A[1], A3 = A[2];\n    var x = A1 - C1, y = A2 - C2, z = A3 - C3;\n    return Sylvester.Line.create([\n      C1 + R[0][0] * x + R[0][1] * y + R[0][2] * z,\n      C2 + R[1][0] * x + R[1][1] * y + R[1][2] * z,\n      C3 + R[2][0] * x + R[2][1] * y + R[2][2] * z\n    ], [\n      R[0][0] * D[0] + R[0][1] * D[1] + R[0][2] * D[2],\n      R[1][0] * D[0] + R[1][1] * D[1] + R[1][2] * D[2],\n      R[2][0] * D[0] + R[2][1] * D[1] + R[2][2] * D[2]\n    ]);\n  },\n\n  reverse: function() {\n    return Sylvester.Line.create(this.anchor, this.direction.x(-1));\n  },\n\n  reflectionIn: function(obj) {\n    if (obj.normal) {\n      // obj is a plane\n      var A = this.anchor.elements, D = this.direction.elements;\n      var A1 = A[0], A2 = A[1], A3 = A[2], D1 = D[0], D2 = D[1], D3 = D[2];\n      var newA = this.anchor.reflectionIn(obj).elements;\n      // Add the line's direction vector to its anchor, then mirror that in the plane\n      var AD1 = A1 + D1, AD2 = A2 + D2, AD3 = A3 + D3;\n      var Q = obj.pointClosestTo([AD1, AD2, AD3]).elements;\n      var newD = [Q[0] + (Q[0] - AD1) - newA[0], Q[1] + (Q[1] - AD2) - newA[1], Q[2] + (Q[2] - AD3) - newA[2]];\n      return Sylvester.Line.create(newA, newD);\n    } else if (obj.direction) {\n      // obj is a line - reflection obtained by rotating PI radians about obj\n      return this.rotate(Math.PI, obj);\n    } else {\n      // obj is a point - just reflect the line's anchor in it\n      var P = obj.elements || obj;\n      return Sylvester.Line.create(this.anchor.reflectionIn([P[0], P[1], (P[2] || 0)]), this.direction);\n    }\n  },\n\n  setVectors: function(anchor, direction) {\n    // Need to do this so that line's properties are not references to the\n    // arguments passed in\n    anchor = Sylvester.Vector.create(anchor);\n    direction = Sylvester.Vector.create(direction);\n    if (anchor.elements.length === 2) {anchor.elements.push(0); }\n    if (direction.elements.length === 2) { direction.elements.push(0); }\n    if (anchor.elements.length > 3 || direction.elements.length > 3) { return null; }\n    var mod = direction.modulus();\n    if (mod === 0) { return null; }\n    this.anchor = anchor;\n    this.direction = Sylvester.Vector.create([\n      direction.elements[0] / mod,\n      direction.elements[1] / mod,\n      direction.elements[2] / mod\n    ]);\n    return this;\n  }\n};\n\nSylvester.Line.create = function(anchor, direction) {\n  var L = new Sylvester.Line();\n  return L.setVectors(anchor, direction);\n};\nvar $L = Sylvester.Line.create;\n\nSylvester.Line.X = Sylvester.Line.create(Sylvester.Vector.Zero(3), Sylvester.Vector.i);\nSylvester.Line.Y = Sylvester.Line.create(Sylvester.Vector.Zero(3), Sylvester.Vector.j);\nSylvester.Line.Z = Sylvester.Line.create(Sylvester.Vector.Zero(3), Sylvester.Vector.k);\n\nSylvester.Line.Segment = function() {};\n\nSylvester.Line.Segment.prototype = {\n  eql: function(segment) {\n    return (this.start.eql(segment.start) && this.end.eql(segment.end)) ||\n        (this.start.eql(segment.end) && this.end.eql(segment.start));\n  },\n\n  dup: function() {\n    return Sylvester.Line.Segment.create(this.start, this.end);\n  },\n\n  length: function() {\n    var A = this.start.elements, B = this.end.elements;\n    var C1 = B[0] - A[0], C2 = B[1] - A[1], C3 = B[2] - A[2];\n    return Math.sqrt(C1*C1 + C2*C2 + C3*C3);\n  },\n\n  toVector: function() {\n    var A = this.start.elements, B = this.end.elements;\n    return Sylvester.Vector.create([B[0] - A[0], B[1] - A[1], B[2] - A[2]]);\n  },\n\n  midpoint: function() {\n    var A = this.start.elements, B = this.end.elements;\n    return Sylvester.Vector.create([(B[0] + A[0])/2, (B[1] + A[1])/2, (B[2] + A[2])/2]);\n  },\n\n  bisectingPlane: function() {\n    return Sylvester.Plane.create(this.midpoint(), this.toVector());\n  },\n\n  translate: function(vector) {\n    var V = vector.elements || vector;\n    var S = this.start.elements, E = this.end.elements;\n    return Sylvester.Line.Segment.create(\n      [S[0] + V[0], S[1] + V[1], S[2] + (V[2] || 0)],\n      [E[0] + V[0], E[1] + V[1], E[2] + (V[2] || 0)]\n    );\n  },\n\n  isParallelTo: function(obj) {\n    return this.line.isParallelTo(obj);\n  },\n\n  distanceFrom: function(obj) {\n    var P = this.pointClosestTo(obj);\n    return (P === null) ? null : P.distanceFrom(obj);\n  },\n\n  contains: function(obj) {\n    if (obj.start && obj.end) { return this.contains(obj.start) && this.contains(obj.end); }\n    var P = (obj.elements || obj).slice();\n    if (P.length === 2) { P.push(0); }\n    if (this.start.eql(P)) { return true; }\n    var S = this.start.elements;\n    var V = Sylvester.Vector.create([S[0] - P[0], S[1] - P[1], S[2] - (P[2] || 0)]);\n    var vect = this.toVector();\n    return V.isAntiparallelTo(vect) && V.modulus() <= vect.modulus();\n  },\n\n  intersects: function(obj) {\n    return (this.intersectionWith(obj) !== null);\n  },\n\n  intersectionWith: function(obj) {\n    if (!this.line.intersects(obj)) { return null; }\n    var P = this.line.intersectionWith(obj);\n    return (this.contains(P) ? P : null);\n  },\n\n  pointClosestTo: function(obj) {\n    if (obj.normal) {\n      // obj is a plane\n      var V = this.line.intersectionWith(obj);\n      if (V === null) { return null; }\n      return this.pointClosestTo(V);\n    } else {\n      // obj is a line (segment) or point\n      var P = this.line.pointClosestTo(obj);\n      if (P === null) { return null; }\n      if (this.contains(P)) { return P; }\n      return (this.line.positionOf(P) < 0 ? this.start : this.end).dup();\n    }\n  },\n\n  setPoints: function(startPoint, endPoint) {\n    startPoint = Sylvester.Vector.create(startPoint).to3D();\n    endPoint = Sylvester.Vector.create(endPoint).to3D();\n    if (startPoint === null || endPoint === null) { return null; }\n    this.line = Sylvester.Line.create(startPoint, endPoint.subtract(startPoint));\n    this.start = startPoint;\n    this.end = endPoint;\n    return this;\n  }\n};\n\nSylvester.Line.Segment.create = function(v1, v2) {\n  var S = new Sylvester.Line.Segment();\n  return S.setPoints(v1, v2);\n};\n\nSylvester.Plane = function() {};\n\nSylvester.Plane.prototype = {\n  eql: function(plane) {\n    return (this.contains(plane.anchor) && this.isParallelTo(plane));\n  },\n\n  dup: function() {\n    return Sylvester.Plane.create(this.anchor, this.normal);\n  },\n\n  translate: function(vector) {\n    var V = vector.elements || vector;\n    return Sylvester.Plane.create([\n      this.anchor.elements[0] + V[0],\n      this.anchor.elements[1] + V[1],\n      this.anchor.elements[2] + (V[2] || 0)\n    ], this.normal);\n  },\n\n  isParallelTo: function(obj) {\n    var theta;\n    if (obj.normal) {\n      // obj is a plane\n      theta = this.normal.angleFrom(obj.normal);\n      return (Math.abs(theta) <= Sylvester.precision || Math.abs(Math.PI - theta) <= Sylvester.precision);\n    } else if (obj.direction) {\n      // obj is a line\n      return this.normal.isPerpendicularTo(obj.direction);\n    }\n    return null;\n  },\n\n  isPerpendicularTo: function(plane) {\n    var theta = this.normal.angleFrom(plane.normal);\n    return (Math.abs(Math.PI/2 - theta) <= Sylvester.precision);\n  },\n\n  distanceFrom: function(obj) {\n    if (this.intersects(obj) || this.contains(obj)) { return 0; }\n    if (obj.anchor) {\n      // obj is a plane or line\n      var A = this.anchor.elements, B = obj.anchor.elements, N = this.normal.elements;\n      return Math.abs((A[0] - B[0]) * N[0] + (A[1] - B[1]) * N[1] + (A[2] - B[2]) * N[2]);\n    } else {\n      // obj is a point\n      var P = obj.elements || obj;\n      var A = this.anchor.elements, N = this.normal.elements;\n      return Math.abs((A[0] - P[0]) * N[0] + (A[1] - P[1]) * N[1] + (A[2] - (P[2] || 0)) * N[2]);\n    }\n  },\n\n  contains: function(obj) {\n    if (obj.normal) { return null; }\n    if (obj.direction) {\n      return (this.contains(obj.anchor) && this.contains(obj.anchor.add(obj.direction)));\n    } else {\n      var P = obj.elements || obj;\n      var A = this.anchor.elements, N = this.normal.elements;\n      var diff = Math.abs(N[0]*(A[0] - P[0]) + N[1]*(A[1] - P[1]) + N[2]*(A[2] - (P[2] || 0)));\n      return (diff <= Sylvester.precision);\n    }\n  },\n\n  intersects: function(obj) {\n    if (typeof(obj.direction) === 'undefined' && typeof(obj.normal) === 'undefined') { return null; }\n    return !this.isParallelTo(obj);\n  },\n\n  intersectionWith: function(obj) {\n    if (!this.intersects(obj)) { return null; }\n    if (obj.direction) {\n      // obj is a line\n      var A = obj.anchor.elements, D = obj.direction.elements,\n          P = this.anchor.elements, N = this.normal.elements;\n      var multiplier = (N[0]*(P[0]-A[0]) + N[1]*(P[1]-A[1]) + N[2]*(P[2]-A[2])) / (N[0]*D[0] + N[1]*D[1] + N[2]*D[2]);\n      return Sylvester.Vector.create([A[0] + D[0]*multiplier, A[1] + D[1]*multiplier, A[2] + D[2]*multiplier]);\n    } else if (obj.normal) {\n      // obj is a plane\n      var direction = this.normal.cross(obj.normal).toUnitVector();\n      // To find an anchor point, we find one co-ordinate that has a value of\n      // zero somewhere on the intersection, and remember which one we picked\n      var N = this.normal.elements, A = this.anchor.elements,\n          O = obj.normal.elements, B = obj.anchor.elements;\n      var solver = Sylvester.Matrix.Zero(2,2), i = 0;\n      while (solver.isSingular()) {\n        i++;\n        solver = Sylvester.Matrix.create([\n          [ N[i%3], N[(i+1)%3] ],\n          [ O[i%3], O[(i+1)%3]  ]\n        ]);\n      }\n      // Then we solve the simultaneous equations in the remaining dimensions\n      var inverse = solver.inverse().elements;\n      var x = N[0]*A[0] + N[1]*A[1] + N[2]*A[2];\n      var y = O[0]*B[0] + O[1]*B[1] + O[2]*B[2];\n      var intersection = [\n        inverse[0][0] * x + inverse[0][1] * y,\n        inverse[1][0] * x + inverse[1][1] * y\n      ];\n      var anchor = [];\n      for (var j = 1; j <= 3; j++) {\n        // This formula picks the right element from intersection by cycling\n        // depending on which element we set to zero above\n        anchor.push((i === j) ? 0 : intersection[(j + (5 - i)%3)%3]);\n      }\n      return Sylvester.Line.create(anchor, direction);\n    }\n  },\n\n  pointClosestTo: function(point) {\n    var P = point.elements || point;\n    var A = this.anchor.elements, N = this.normal.elements;\n    var dot = (A[0] - P[0]) * N[0] + (A[1] - P[1]) * N[1] + (A[2] - (P[2] || 0)) * N[2];\n    return Sylvester.Vector.create([P[0] + N[0] * dot, P[1] + N[1] * dot, (P[2] || 0) + N[2] * dot]);\n  },\n\n  rotate: function(t, line) {\n    var R = t.determinant ? t.elements : Sylvester.Matrix.Rotation(t, line.direction).elements;\n    var C = line.pointClosestTo(this.anchor).elements;\n    var A = this.anchor.elements, N = this.normal.elements;\n    var C1 = C[0], C2 = C[1], C3 = C[2], A1 = A[0], A2 = A[1], A3 = A[2];\n    var x = A1 - C1, y = A2 - C2, z = A3 - C3;\n    return Sylvester.Plane.create([\n      C1 + R[0][0] * x + R[0][1] * y + R[0][2] * z,\n      C2 + R[1][0] * x + R[1][1] * y + R[1][2] * z,\n      C3 + R[2][0] * x + R[2][1] * y + R[2][2] * z\n    ], [\n      R[0][0] * N[0] + R[0][1] * N[1] + R[0][2] * N[2],\n      R[1][0] * N[0] + R[1][1] * N[1] + R[1][2] * N[2],\n      R[2][0] * N[0] + R[2][1] * N[1] + R[2][2] * N[2]\n    ]);\n  },\n\n  reflectionIn: function(obj) {\n    if (obj.normal) {\n      // obj is a plane\n      var A = this.anchor.elements, N = this.normal.elements;\n      var A1 = A[0], A2 = A[1], A3 = A[2], N1 = N[0], N2 = N[1], N3 = N[2];\n      var newA = this.anchor.reflectionIn(obj).elements;\n      // Add the plane's normal to its anchor, then mirror that in the other plane\n      var AN1 = A1 + N1, AN2 = A2 + N2, AN3 = A3 + N3;\n      var Q = obj.pointClosestTo([AN1, AN2, AN3]).elements;\n      var newN = [Q[0] + (Q[0] - AN1) - newA[0], Q[1] + (Q[1] - AN2) - newA[1], Q[2] + (Q[2] - AN3) - newA[2]];\n      return Sylvester.Plane.create(newA, newN);\n    } else if (obj.direction) {\n      // obj is a line\n      return this.rotate(Math.PI, obj);\n    } else {\n      // obj is a point\n      var P = obj.elements || obj;\n      return Sylvester.Plane.create(this.anchor.reflectionIn([P[0], P[1], (P[2] || 0)]), this.normal);\n    }\n  },\n\n  setVectors: function(anchor, v1, v2) {\n    anchor = Sylvester.Vector.create(anchor);\n    anchor = anchor.to3D(); if (anchor === null) { return null; }\n    v1 = Sylvester.Vector.create(v1);\n    v1 = v1.to3D(); if (v1 === null) { return null; }\n    if (typeof(v2) === 'undefined') {\n      v2 = null;\n    } else {\n      v2 = Sylvester.Vector.create(v2);\n      v2 = v2.to3D(); if (v2 === null) { return null; }\n    }\n    var A1 = anchor.elements[0], A2 = anchor.elements[1], A3 = anchor.elements[2];\n    var v11 = v1.elements[0], v12 = v1.elements[1], v13 = v1.elements[2];\n    var normal, mod;\n    if (v2 !== null) {\n      var v21 = v2.elements[0], v22 = v2.elements[1], v23 = v2.elements[2];\n      normal = Sylvester.Vector.create([\n        (v12 - A2) * (v23 - A3) - (v13 - A3) * (v22 - A2),\n        (v13 - A3) * (v21 - A1) - (v11 - A1) * (v23 - A3),\n        (v11 - A1) * (v22 - A2) - (v12 - A2) * (v21 - A1)\n      ]);\n      mod = normal.modulus();\n      if (mod === 0) { return null; }\n      normal = Sylvester.Vector.create([normal.elements[0] / mod, normal.elements[1] / mod, normal.elements[2] / mod]);\n    } else {\n      mod = Math.sqrt(v11*v11 + v12*v12 + v13*v13);\n      if (mod === 0) { return null; }\n      normal = Sylvester.Vector.create([v1.elements[0] / mod, v1.elements[1] / mod, v1.elements[2] / mod]);\n    }\n    this.anchor = anchor;\n    this.normal = normal;\n    return this;\n  }\n};\n\nSylvester.Plane.create = function(anchor, v1, v2) {\n  var P = new Sylvester.Plane();\n  return P.setVectors(anchor, v1, v2);\n};\nvar $P = Sylvester.Plane.create;\n\nSylvester.Plane.XY = Sylvester.Plane.create(Sylvester.Vector.Zero(3), Sylvester.Vector.k);\nSylvester.Plane.YZ = Sylvester.Plane.create(Sylvester.Vector.Zero(3), Sylvester.Vector.i);\nSylvester.Plane.ZX = Sylvester.Plane.create(Sylvester.Vector.Zero(3), Sylvester.Vector.j);\nSylvester.Plane.YX = Sylvester.Plane.XY; Sylvester.Plane.ZY = Sylvester.Plane.YZ; Sylvester.Plane.XZ = Sylvester.Plane.ZX;\n\nSylvester.Plane.fromPoints = function(points) {\n  var np = points.length, list = [], i, P, n, N, A, B, C, D, theta, prevN, totalN = Sylvester.Vector.Zero(3);\n  for (i = 0; i < np; i++) {\n    P = Sylvester.Vector.create(points[i]).to3D();\n    if (P === null) { return null; }\n    list.push(P);\n    n = list.length;\n    if (n > 2) {\n      // Compute plane normal for the latest three points\n      A = list[n-1].elements; B = list[n-2].elements; C = list[n-3].elements;\n      N = Sylvester.Vector.create([\n        (A[1] - B[1]) * (C[2] - B[2]) - (A[2] - B[2]) * (C[1] - B[1]),\n        (A[2] - B[2]) * (C[0] - B[0]) - (A[0] - B[0]) * (C[2] - B[2]),\n        (A[0] - B[0]) * (C[1] - B[1]) - (A[1] - B[1]) * (C[0] - B[0])\n      ]).toUnitVector();\n      if (n > 3) {\n        // If the latest normal is not (anti)parallel to the previous one, we've\n        // strayed off the plane. This might be a slightly long-winded way of\n        // doing things, but we need the sum of all the normals to find which\n        // way the plane normal should point so that the points form an\n        // anticlockwise list.\n        theta = N.angleFrom(prevN);\n        if (theta !== null) {\n          if (!(Math.abs(theta) <= Sylvester.precision || Math.abs(theta - Math.PI) <= Sylvester.precision)) { return null; }\n        }\n      }\n      totalN = totalN.add(N);\n      prevN = N;\n    }\n  }\n  // We need to add in the normals at the start and end points, which the above\n  // misses out\n  A = list[1].elements; B = list[0].elements; C = list[n-1].elements; D = list[n-2].elements;\n  totalN = totalN.add(Sylvester.Vector.create([\n    (A[1] - B[1]) * (C[2] - B[2]) - (A[2] - B[2]) * (C[1] - B[1]),\n    (A[2] - B[2]) * (C[0] - B[0]) - (A[0] - B[0]) * (C[2] - B[2]),\n    (A[0] - B[0]) * (C[1] - B[1]) - (A[1] - B[1]) * (C[0] - B[0])\n  ]).toUnitVector()).add(Sylvester.Vector.create([\n    (B[1] - C[1]) * (D[2] - C[2]) - (B[2] - C[2]) * (D[1] - C[1]),\n    (B[2] - C[2]) * (D[0] - C[0]) - (B[0] - C[0]) * (D[2] - C[2]),\n    (B[0] - C[0]) * (D[1] - C[1]) - (B[1] - C[1]) * (D[0] - C[0])\n  ]).toUnitVector());\n  return Sylvester.Plane.create(list[0], totalN);\n};\n\nSylvester.Polygon = function() {};\n\nSylvester.Polygon.prototype = {\n  v: function(i) {\n    return this.vertices.at(i - 1).data;\n  },\n\n  nodeFor: function(vertex) {\n    return this.vertices.withData(vertex);\n  },\n\n  dup: function() {\n    return Sylvester.Polygon.create(this.vertices, this.plane);\n  },\n\n  translate: function(vector) {\n    var P = vector.elements || vector;\n    this.vertices.each(function(node) {\n      var E = node.data.elements;\n      node.data.setElements([E[0] + P[0], E[1] + P[1], E[2] + (P[2] || 0)]);\n    });\n    this.plane = this.plane.translate(vector);\n    this.updateTrianglePlanes(function(plane) { return plane.translate(vector); });\n    return this;\n  },\n\n  rotate: function(t, line) {\n    var R = Sylvester.Matrix.Rotation(t, line.direction);\n    this.vertices.each(function(node) {\n      node.data.setElements(node.data.rotate(R, line).elements);\n    });\n    this.plane = this.plane.rotate(R, line);\n    this.updateTrianglePlanes(function(plane) { return plane.rotate(R, line); });\n    return this;\n  },\n\n  scale: function(k, point) {\n    var P = point.elements || point;\n    this.vertices.each(function(node) {\n      var E = node.data.elements;\n      node.data.setElements([\n        P[0] + k * (E[0] - P[0]),\n        P[1] + k * (E[1] - P[1]),\n        (P[2] || 0) + k * (E[2] - (P[2] || 0))\n      ]);\n    });\n    var anchor = this.vertices.first.data;\n    this.plane.anchor.setElements(anchor);\n    this.updateTrianglePlanes(function(plane) { return Sylvester.Plane.create(anchor, plane.normal); });\n    return this;\n  },\n\n  // Updates the plane properties of all the cached triangles belonging to the\n  // polygon according to the given function. For example, suppose you just\n  // rotated the polygon, you should call:\n  //\n  //   poly.updateTrianglePlanes(function(plane) { return plane.rotate(t, line); });\n  //\n  // This method is called automatically by Sylvester.Polygon.translate,\n  // Sylvester.Polygon.rotate and Sylvester.Polygon.scale transformation methods.\n  updateTrianglePlanes: function(fn) {\n    var i;\n    if (this.cached.triangles !== null) {\n      i = this.cached.triangles.length;\n      while (i--) {\n        this.cached.triangles[i].plane = fn(this.cached.triangles[i].plane);\n      }\n    }\n    if (this.cached.surfaceIntegralElements !== null) {\n      i = this.cached.surfaceIntegralElements.length;\n      while (i--) {\n        this.cached.surfaceIntegralElements[i].plane = fn(this.cached.surfaceIntegralElements[i].plane);\n      }\n    }\n  },\n\n  isTriangle: function() {\n    return this.vertices.length === 3;\n  },\n\n  // Returns a collection of triangles used for calculating area and center of\n  // mass. Some of the triangles will not lie inside the polygon - this\n  // collection is essentially a series of itervals in a surface integral, so\n  // some are 'negative'. If you want the polygon broken into constituent\n  // triangles, use toTriangles(). This method is used because it's much faster\n  // than toTriangles().\n  //\n  // The triangles generated share vertices with the original polygon, so they\n  // transform with the polygon. They are cached after first calculation and\n  // should remain in sync with changes to the parent polygon.\n  trianglesForSurfaceIntegral: function() {\n    if (this.cached.surfaceIntegralElements !== null) { return this.cached.surfaceIntegralElements; }\n    var triangles = [];\n    var firstVertex = this.vertices.first.data;\n    var plane = this.plane;\n    this.vertices.each(function(node, i) {\n      if (i < 2) { return; }\n      var points = [firstVertex, node.prev.data, node.data];\n      // If the vertices lie on a straigh line, give the polygon's own plane. If\n      // the element has no area, it doesn't matter which way its normal faces.\n      triangles.push(Sylvester.Polygon.create(points, Sylvester.Plane.fromPoints(points) || plane));\n    });\n    return this.setCache('surfaceIntegralElements', triangles);\n  },\n\n  area: function() {\n    if (this.isTriangle()) {\n      // Area is half the modulus of the cross product of two sides\n      var A = this.vertices.first, B = A.next, C = B.next;\n      A = A.data.elements; B = B.data.elements; C = C.data.elements;\n      return 0.5 * Sylvester.Vector.create([\n        (A[1] - B[1]) * (C[2] - B[2]) - (A[2] - B[2]) * (C[1] - B[1]),\n        (A[2] - B[2]) * (C[0] - B[0]) - (A[0] - B[0]) * (C[2] - B[2]),\n        (A[0] - B[0]) * (C[1] - B[1]) - (A[1] - B[1]) * (C[0] - B[0])\n      ]).modulus();\n    } else {\n      var trigs = this.trianglesForSurfaceIntegral(), area = 0;\n      var i = trigs.length;\n      while (i--) {\n        area += trigs[i].area() * trigs[i].plane.normal.dot(this.plane.normal);\n      }\n      return area;\n    }\n  },\n\n  centroid: function() {\n    if (this.isTriangle()) {\n      var A = this.v(1).elements, B = this.v(2).elements, C = this.v(3).elements;\n      return Sylvester.Vector.create([(A[0] + B[0] + C[0])/3, (A[1] + B[1] + C[1])/3, (A[2] + B[2] + C[2])/3]);\n    } else {\n      var A, M = 0, V = Sylvester.Vector.Zero(3), P, C, trigs = this.trianglesForSurfaceIntegral();\n      var i = trigs.length;\n      while (i--) {\n        A = trigs[i].area() * trigs[i].plane.normal.dot(this.plane.normal);\n        M += A;\n        P = V.elements;\n        C = trigs[i].centroid().elements;\n        V.setElements([P[0] + C[0] * A, P[1] + C[1] * A, P[2] + C[2] * A]);\n      }\n      return V.x(1/M);\n    }\n  },\n\n  projectionOn: function(plane) {\n    var points = [];\n    this.vertices.each(function(node) { points.push(plane.pointClosestTo(node.data)); });\n    return Sylvester.Polygon.create(points);\n  },\n\n  removeVertex: function(vertex) {\n    if (this.isTriangle()) { return; }\n    var node = this.nodeFor(vertex);\n    if (node === null) { return null; }\n    this.clearCache();\n    // Previous and next entries in the main vertex list\n    var prev = node.prev, next = node.next;\n    var prevWasConvex = prev.data.isConvex(this);\n    var nextWasConvex = next.data.isConvex(this);\n    if (node.data.isConvex(this)) {\n      this.convexVertices.remove(this.convexVertices.withData(node.data));\n    } else {\n      this.reflexVertices.remove(this.reflexVertices.withData(node.data));\n    }\n    this.vertices.remove(node);\n    // Deal with previous vertex's change of class\n    if (prevWasConvex !== prev.data.isConvex(this)) {\n      if (prevWasConvex) {\n        this.convexVertices.remove(this.convexVertices.withData(prev.data));\n        this.reflexVertices.append(new Sylvester.LinkedList.Node(prev.data));\n      } else {\n        this.reflexVertices.remove(this.reflexVertices.withData(prev.data));\n        this.convexVertices.append(new Sylvester.LinkedList.Node(prev.data));\n      }\n    }\n    // Deal with next vertex's change of class\n    if (nextWasConvex !== next.data.isConvex(this)) {\n      if (nextWasConvex) {\n        this.convexVertices.remove(this.convexVertices.withData(next.data));\n        this.reflexVertices.append(new Sylvester.LinkedList.Node(next.data));\n      } else {\n        this.reflexVertices.remove(this.reflexVertices.withData(next.data));\n        this.convexVertices.append(new Sylvester.LinkedList.Node(next.data));\n      }\n    }\n    return this;\n  },\n\n  contains: function(point) {\n    return this.containsByWindingNumber(point);\n  },\n\n  containsByWindingNumber: function(point) {\n    var P = point.elements || point;\n    if (!this.plane.contains(P)) { return false; }\n    if (this.hasEdgeContaining(P)) { return false; }\n    var V, W, A, B, theta = 0, dt, loops = 0, self = this;\n    this.vertices.each(function(node) {\n      V = node.data.elements;\n      W = node.next.data.elements;\n      A = Sylvester.Vector.create([V[0] - P[0], V[1] - P[1], V[2] - (P[2] || 0)]);\n      B = Sylvester.Vector.create([W[0] - P[0], W[1] - P[1], W[2] - (P[2] || 0)]);\n      dt = A.angleFrom(B);\n      if (dt === null || dt === 0) { return; }\n      theta += (A.cross(B).isParallelTo(self.plane.normal) ? 1 : -1) * dt;\n      if (theta >= 2 * Math.PI - Sylvester.precision) { loops++; theta -= 2 * Math.PI; }\n      if (theta <= -2 * Math.PI + Sylvester.precision) { loops--; theta += 2 * Math.PI; }\n    });\n    return loops !== 0;\n  },\n\n  hasEdgeContaining: function(point) {\n    var P = (point.elements || point);\n    var success = false;\n    this.vertices.each(function(node) {\n      if (Sylvester.Line.Segment.create(node.data, node.next.data).contains(P)) { success = true; }\n    });\n    return success;\n  },\n\n  toTriangles: function() {\n    if (this.cached.triangles !== null) { return this.cached.triangles; }\n    return this.setCache('triangles', this.triangulateByEarClipping());\n  },\n\n  // Implementation of ear clipping algorithm\n  // Found in 'Triangulation by ear clipping', by David Eberly\n  // at http://www.geometrictools.com\n  // This will not deal with overlapping sections - contruct your polygons\n  // sensibly\n  triangulateByEarClipping: function() {\n    var poly = this.dup(), triangles = [], success, convexNode, mainNode, trig;\n    while (!poly.isTriangle()) {\n      success = false;\n      while (!success) {\n        success = true;\n        // Ear tips must be convex vertices - let's pick one at random\n        convexNode = poly.convexVertices.randomNode();\n        mainNode = poly.vertices.withData(convexNode.data);\n        // For convex vertices, this order will always be anticlockwise\n        trig = Sylvester.Polygon.create([mainNode.data, mainNode.next.data, mainNode.prev.data], this.plane);\n        // Now test whether any reflex vertices lie within the ear\n        poly.reflexVertices.each(function(node) {\n          // Don't test points belonging to this triangle. node won't be equal\n          // to convexNode as node is reflex and vertex is convex.\n          if (node.data !== mainNode.prev.data && node.data !== mainNode.next.data) {\n            if (trig.contains(node.data) || trig.hasEdgeContaining(node.data)) { success = false; }\n          }\n        });\n      }\n      triangles.push(trig);\n      poly.removeVertex(mainNode.data);\n    }\n    // Need to do this to renumber the remaining vertices\n    triangles.push(Sylvester.Polygon.create(poly.vertices, this.plane));\n    return triangles;\n  },\n\n  setVertices: function(points, plane) {\n    var pointSet = points.toArray ? points.toArray() : points;\n    this.plane = (plane && plane.normal) ? plane.dup() : Sylvester.Plane.fromPoints(pointSet);\n    if (this.plane === null) { return null; }\n    this.vertices = new Sylvester.LinkedList.Circular();\n    // Construct linked list of vertices. If each point is already a polygon\n    // vertex, we reference it rather than creating a new vertex.\n    var i = pointSet.length, newVertex;\n    while (i--) {\n      newVertex = pointSet[i].isConvex ? pointSet[i] : new Sylvester.Polygon.Vertex(pointSet[i]);\n      this.vertices.prepend(new Sylvester.LinkedList.Node(newVertex));\n    }\n    this.clearCache();\n    this.populateVertexTypeLists();\n    return this;\n  },\n\n  populateVertexTypeLists: function() {\n    this.convexVertices = new Sylvester.LinkedList.Circular();\n    this.reflexVertices = new Sylvester.LinkedList.Circular();\n    var self = this;\n    this.vertices.each(function(node) {\n      // Split vertices into convex / reflex groups. The\n      // Sylvester.LinkedList.Node class wraps each vertex so it can belong to\n      // many linked lists.\n      self[node.data.type(self) + 'Vertices'].append(new Sylvester.LinkedList.Node(node.data));\n    });\n  },\n\n  copyVertices: function() {\n    this.clearCache();\n    this.vertices.each(function(node) {\n      node.data = new Sylvester.Polygon.Vertex(node.data);\n    });\n    this.populateVertexTypeLists();\n  },\n\n  clearCache: function() {\n    this.cached = {\n      triangles: null,\n      surfaceIntegralElements: null\n    };\n  },\n\n  setCache: function(key, value) {\n    this.cached[key] = value;\n    return value;\n  },\n\n  inspect: function() {\n    var points = [];\n    this.vertices.each(function(node) { points.push(node.data.inspect()); });\n    return points.join(' -> ');\n  }\n};\n\nSylvester.Polygon.create = function(points, plane) {\n  var P = new Sylvester.Polygon();\n  return P.setVertices(points, plane);\n};\n\nSylvester.Polygon.Vertex = function(point) {\n  this.setElements(point);\n  if (this.elements.length === 2) { this.elements.push(0); }\n  if (this.elements.length !== 3) { return null; }\n};\nSylvester.Polygon.Vertex.prototype = new Sylvester.Vector;\n\n// Returns true iff the vertex's internal angle is 0 <= x < 180\n// in the context of the given polygon object. Returns null if the\n// vertex does not exist in the polygon.\nSylvester.Polygon.Vertex.prototype.isConvex = function(polygon) {\n  var node = polygon.nodeFor(this);\n  if (node === null) { return null; }\n  var prev = node.prev.data, next = node.next.data;\n  var A = next.subtract(this);\n  var B = prev.subtract(this);\n  var theta = A.angleFrom(B);\n  if (theta <= Sylvester.precision) { return true; }\n  if (Math.abs(theta - Math.PI) <= Sylvester.precision) { return false; }\n  return (A.cross(B).dot(polygon.plane.normal) > 0);\n};\n// Returns true iff the vertex's internal angle is 180 <= x < 360\nSylvester.Polygon.Vertex.prototype.isReflex = function(polygon) {\n  var result = this.isConvex(polygon);\n  return (result === null) ? null : !result;\n};\nSylvester.Polygon.Vertex.prototype.type = function(polygon) {\n  var result = this.isConvex(polygon);\n  return (result === null) ? null : (result ? 'convex' : 'reflex');\n};\n\n// Method for converting a set of arrays/vectors/whatever to a set of Sylvester.Polygon.Vertex objects\nSylvester.Polygon.Vertex.convert = function(points) {\n  var pointSet = points.toArray ? points.toArray() : points;\n  var list = [], n = pointSet.length;\n  for (var i = 0; i < n; i++) {\n    list.push(new Sylvester.Polygon.Vertex(pointSet[i]));\n  }\n  return list;\n};\n\nSylvester.LinkedList = function() {};\n\nSylvester.LinkedList.prototype = {\n  length: 0,\n  first: null,\n  last: null,\n\n  forEach: function(fn, context) {\n    var node = this.first, n = this.length;\n    for (var i = 0; i < n; i++) {\n      fn.call(context, node, i);\n      node = node.next;\n    }\n  },\n\n  at: function(i) {\n    if (!(i >= 0 && i < this.length)) { return null; }\n    var node = this.first;\n    while (i--) { node = node.next; }\n    return node;\n  },\n\n  randomNode: function() {\n    var n = Math.floor(Math.random() * this.length);\n    return this.at(n);\n  },\n\n  toArray: function() {\n    var arr = [], node = this.first, n = this.length;\n    while (n--) {\n      arr.push(node.data || node);\n      node = node.next;\n    }\n    return arr;\n  }\n};\n\nSylvester.LinkedList.prototype.each = Sylvester.LinkedList.prototype.forEach;\n\nSylvester.LinkedList.Node = function(data) {\n  this.prev = null; this.next = null;\n  this.data = data;\n};\n\nSylvester.LinkedList.Circular = function() {};\nSylvester.LinkedList.Circular.Methods = {\n  append: function(node) {\n    if (this.first === null) {\n      node.prev = node;\n      node.next = node;\n      this.first = node;\n      this.last = node;\n    } else {\n      node.prev = this.last;\n      node.next = this.first;\n      this.first.prev = node;\n      this.last.next = node;\n      this.last = node;\n    }\n    this.length++;\n  },\n\n  prepend: function(node) {\n    if (this.first === null) {\n      this.append(node);\n      return;\n    } else {\n      node.prev = this.last;\n      node.next = this.first;\n      this.first.prev = node;\n      this.last.next = node;\n      this.first = node;\n    }\n    this.length++;\n  },\n\n  insertAfter: function(node, newNode) {\n    newNode.prev = node;\n    newNode.next = node.next;\n    node.next.prev = newNode;\n    node.next = newNode;\n    if (newNode.prev === this.last) { this.last = newNode; }\n    this.length++;\n  },\n\n  insertBefore: function(node, newNode) {\n    newNode.prev = node.prev;\n    newNode.next = node;\n    node.prev.next = newNode;\n    node.prev = newNode;\n    if (newNode.next === this.first) { this.first = newNode; }\n    this.length++;\n  },\n\n  remove: function(node) {\n    if (this.length > 1) {\n      node.prev.next = node.next;\n      node.next.prev = node.prev;\n      if (node === this.first) { this.first = node.next; }\n      if (node === this.last) { this.last = node.prev; }\n    } else {\n      this.first = null;\n      this.last = null;\n    }\n    node.prev = null;\n    node.next = null;\n    this.length--;\n  },\n\n  withData: function(data) {\n    var nodeFromStart = this.first, nodeFromEnd = this.last, n = Math.ceil(this.length / 2);\n    while (n--) {\n      if (nodeFromStart.data === data) { return nodeFromStart; }\n      if (nodeFromEnd.data === data) { return nodeFromEnd; }\n      nodeFromStart = nodeFromStart.next;\n      nodeFromEnd = nodeFromEnd.prev;\n    }\n    return null;\n  }\n};\n\nSylvester.LinkedList.Circular.prototype = new Sylvester.LinkedList;\nfor (var method in Sylvester.LinkedList.Circular.Methods) {\n  Sylvester.LinkedList.Circular.prototype[method] = Sylvester.LinkedList.Circular.Methods[method];\n}\n\nSylvester.LinkedList.Circular.fromArray = function(list, useNodes) {\n  var linked = new Sylvester.LinkedList.Circular();\n  var n = list.length;\n  while (n--) { linked.prepend(useNodes ? new Sylvester.LinkedList.Node(list[n]) : list[n]); }\n  return linked;\n};\n\n(function() {\n  var api = (typeof require === 'function' && typeof exports === 'object')\n          ? exports\n          : this;\n\n  api.Line    = Sylvester.Line;\n  api.Matrix  = Sylvester.Matrix;\n  api.Plane   = Sylvester.Plane;\n  api.Polygon = Sylvester.Polygon;\n  api.Vector  = Sylvester.Vector;\n\n  if (typeof WScript !== 'undefined')\n    this.Sylvester = Sylvester;\n})();\n","// CommonJS style module & browserify support\nif (typeof require === 'function' && typeof exports === 'object') {\n  var Sylvester = require('sylvester');\n\n  var Vector = Sylvester.Vector;\n  var Matrix = Sylvester.Matrix;\n  var $V = Sylvester.Vector.create;\n  var $M = Sylvester.Matrix.create;\n\n  Sylvester.makeLookAt      = makeLookAt\n  Sylvester.makePerspective = makePerspective\n  Sylvester.makeFrustum     = makeFrustum\n  Sylvester.makeOrtho       = makeOrtho\n}\n\n// Make translation transform matrix\nMatrix.Translation = function(v) {\n  var r;\n  switch(v.elements.length) {\n  case 2:\n    r = Matrix.I(3);\n    r.elements[2][0] = v.elements[0];\n    r.elements[2][1] = v.elements[1];\n    return r;\n  case 3:\n    r = Matrix.I(4);\n    r.elements[0][3] = v.elements[0];\n    r.elements[1][3] = v.elements[1];\n    r.elements[2][3] = v.elements[2];\n    return r;\n  }\n\n  throw new Error('Invalid length for Translation', 'sylvester-utils.js', 18);\n};\n\n// return column-major flattened matrix in array form\nMatrix.prototype.flatten = function() {\n  var result = [];\n\n  if (this.elements.length !== 0) {\n    var cols = this.elements[0].length;\n    for (var j = 0; j < cols; j++) {\n      var rows = this.elements.length;\n      for (var i = 0; i < rows; i++) {\n        result.push(this.elements[i][j]);\n      }\n    }\n  }\n\n  return result;\n};\n\n// if Matrix is smaller or equal to 4x4: make it 4x4\n// else: do nothing and return null\nMatrix.prototype.ensure4x4 = function() {\n  var dim = this.elements;\n  var rows = dim.length;\n  var cols = dim[0].length;\n\n  if (rows === 4 && cols === 4) return this;\n  if (rows > 4 || cols > 4) return null;\n\n  var i, j;\n  // Extending each rows\n  for (i = 0; i < rows; ++i) {\n    var row = dim[i];\n    for (j = row.length; j < 4; ++j) {\n      row.push( i === j ? 1 : 0 );\n    }\n  }\n\n  // Making new rows\n  switch(rows) {\n  case 0:\n    dim.push([1, 0, 0, 0]);\n    /* falls through */\n  case 1:\n    dim.push([0, 1, 0, 0]);\n    /* falls through */\n  case 2:\n    dim.push([0, 0, 1, 0]);\n    /* falls through */\n  case 3:\n    dim.push([0, 0, 0, 1]);\n  }\n\n  return this;\n};\n\n// if matrix is 4x4: return 3x3 subset of it\n// else: do nothing and return null\nMatrix.prototype.make3x3 = function() {\n  return this.elements.length === 4 && this.elements[0].length === 4 ?\n    Matrix.create([[this.elements[0][0], this.elements[0][1], this.elements[0][2]],\n      [this.elements[1][0], this.elements[1][1], this.elements[1][2]],\n      [this.elements[2][0], this.elements[2][1], this.elements[2][2]]]) :\n    null;\n};\n\n// return the vector in array form\nVector.prototype.flatten = function () { return this.elements; };\n\n// make a viewing transformation (gluLookAt)\nfunction makeLookAt(ex, ey, ez, cx, cy, cz, ux, uy, uz) {\n  var eye = $V([ex, ey, ez]);\n  var center = $V([cx, cy, cz]);\n  var up = $V([ux, uy, uz]);\n\n  var z = eye.subtract(center).toUnitVector();\n  var x = up.cross(z).toUnitVector();\n  var y = z.cross(x).toUnitVector();\n\n  var m = $M([[x.e(1), x.e(2), x.e(3), 0],\n      [y.e(1), y.e(2), y.e(3), 0],\n      [z.e(1), z.e(2), z.e(3), 0],\n      [0, 0, 0, 1]]);\n\n  var t = $M([[1, 0, 0, -ex],\n      [0, 1, 0, -ey],\n      [0, 0, 1, -ez],\n      [0, 0, 0, 1]]);\n  return m.x(t);\n}\n\n// make a perspective projection matrix (gluPerspective)\nfunction makePerspective(fovy, aspect, znear, zfar) {\n  var ymax = znear * Math.tan(fovy * Math.PI / 360.0);\n  var ymin = -ymax;\n  var xmin = ymin * aspect;\n  var xmax = ymax * aspect;\n\n  return makeFrustum(xmin, xmax, ymin, ymax, znear, zfar);\n}\n\n// make a perspective matrix (glFrustum)\nfunction makeFrustum(left, right, bottom, top, znear, zfar) {\n  var X = 2*znear/(right-left);\n  var Y = 2*znear/(top-bottom);\n  var A = (right+left)/(right-left);\n  var B = (top+bottom)/(top-bottom);\n  var C = -(zfar+znear)/(zfar-znear);\n  var D = -2*zfar*znear/(zfar-znear);\n\n  return $M([[X, 0, A, 0],\n      [0, Y, B, 0],\n      [0, 0, C, D],\n      [0, 0, -1, 0]]);\n}\n\n// make an orthographic matrix (glOrtho)\nfunction makeOrtho(left, right, bottom, top, znear, zfar) {\n  var tx = - (right + left) / (right - left);\n  var ty = - (top + bottom) / (top - bottom);\n  var tz = - (zfar + znear) / (zfar - znear);\n\n  return $M([[2 / (right - left), 0, 0, tx],\n      [0, 2 / (top - bottom), 0, ty],\n      [0, 0, -2 / (zfar - znear), tz],\n      [0, 0, 0, 1]]);\n}\n"],"names":["sylvester","Matrix","$V","makePerspective","gl","Sylvester","method","precision","Vector","create","elements","setElements","Random","n","push","Math","random","Zero","prototype","e","i","this","length","dimensions","modulus","sqrt","dot","eql","vector","V","abs","dup","map","fn","context","each","x","call","forEach","toUnitVector","r","angleFrom","mod1","mod2","theta","acos","isParallelTo","angle","isAntiparallelTo","PI","isPerpendicularTo","add","subtract","multiply","k","product","cross","B","A","max","m","indexOf","index","toDiagonalMatrix","Diagonal","round","snapTo","y","distanceFrom","obj","anchor","start","end","part","sum","liesOn","line","contains","liesIn","plane","rotate","t","z","R","determinant","Rotation","direction","C","pointClosestTo","reflectionIn","P","slice","Q","to3D","inspect","join","els","j","I","M","a","cos","sin","axis","mod","s","c","RotationX","RotationY","RotationZ","row","col","cols","rows","matrix","nj","isSameSizeAs","canMultiplyFromLeft","returnVector","minor","b","d","ni","transpose","isSquare","diagonal","toRightTriangular","p","np","multiplier","det","isSingular","trace","tr","rank","augment","T","inverse","divisor","new_element","inverse_elements","matrix_rows","toUpperTriangular","rk","inv","Line","translate","normal","N","D","PA1","PA2","PA3","modPA","cosTheta","sin2","dist","positionOf","point","intersects","intersectionWith","X","Y","X1","X2","X3","Y1","Y2","Y3","PsubQ1","PsubQ2","PsubQ3","YdotY","XdotY","E","D1","D2","D3","E1","E2","E3","Plane","A1","A2","A3","C1","C2","C3","reverse","newA","AD1","AD2","AD3","newD","setVectors","Z","Segment","segment","toVector","midpoint","bisectingPlane","S","vect","setPoints","startPoint","endPoint","v1","v2","O","solver","intersection","N1","N2","N3","AN1","AN2","AN3","newN","v11","v12","v13","v21","v22","v23","XY","YZ","ZX","YX","ZY","XZ","fromPoints","points","prevN","list","totalN","Polygon","v","vertices","at","data","nodeFor","vertex","withData","node","updateTrianglePlanes","scale","first","cached","triangles","surfaceIntegralElements","isTriangle","trianglesForSurfaceIntegral","firstVertex","prev","setCache","area","next","trigs","centroid","projectionOn","removeVertex","clearCache","prevWasConvex","isConvex","nextWasConvex","convexVertices","remove","reflexVertices","append","LinkedList","Node","containsByWindingNumber","hasEdgeContaining","W","dt","loops","self","success","toTriangles","triangulateByEarClipping","convexNode","mainNode","trig","poly","randomNode","setVertices","pointSet","toArray","Circular","newVertex","Vertex","prepend","populateVertexTypeLists","type","copyVertices","key","value","polygon","isReflex","result","convert","last","floor","arr","Methods","insertAfter","newNode","insertBefore","nodeFromStart","nodeFromEnd","ceil","fromArray","useNodes","linked","api","$d91c669937dcc03f09c45000854ee960$exports","$d91c669937dcc03f09c45000854ee960$var$_typeof","WScript","$d91c669937dcc03f09c45000854ee960$init","$f757c5065c8da4aa5ba8f8d295c$exports","$f757c5065c8da4aa5ba8f8d295c$var$_typeof","$M","makeLookAt","ex","ey","ez","cx","cy","cz","ux","uy","uz","eye","center","up","fovy","aspect","znear","zfar","ymax","tan","ymin","makeFrustum","makeOrtho","left","right","bottom","top","Translation","Error","flatten","ensure4x4","dim","make3x3","canvas","getContext","e$","document","getElementById","flag","makeShader","vs","fs","program","makeAttr","vertexPositionAttribute","vertexColorAttribute","makeBuffer","vb","colorb","this$","resized","window","addEventListener","clearColor","clearDepth","enable","DEPTH_TEST","depthFunc","LEQUAL","shader","code","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","createShader","VERTEX_SHADER","FRAGMENT_SHADER","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","useProgram","name","attr","getAttribLocation","enableVertexAttribArray","ret","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","setInterval","mvMatrix","mvUniform","pMatrix","pUniform","getUniformLocation","uniformMatrix4fv","vertexAttribPointer","FLOAT","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","drawArrays","TRIANGLE_STRIP","width","clientWidth","height","clientHeight","viewport"],"version":3,"file":"index.3618cd82.js.map"}